<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Guiding Center Dynamics in 4D · ChargedParticleDynamics.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ChargedParticleDynamics.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../normalization/">Normalization</a></li><li><a class="tocitem" href="../initialization/">Initialization</a></li><li><a class="tocitem" href="../charged_particle_3d/">Charged Particles in 3D</a></li><li><a class="tocitem" href="../pauli_particle_3d/">Pauli Particles in 3D</a></li><li class="is-active"><a class="tocitem" href>Guiding Center Dynamics in 4D</a><ul class="internal"><li><a class="tocitem" href="#Lagrangian-Formulation"><span>Lagrangian Formulation</span></a></li><li><a class="tocitem" href="#Hamiltonian-Formulation"><span>Hamiltonian Formulation</span></a></li><li><a class="tocitem" href="#Modules"><span>Modules</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Guiding Center Dynamics in 4D</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Guiding Center Dynamics in 4D</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/master/docs/src/guiding_center_4d.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Guiding-Center-Dynamics-in-4D"><a class="docs-heading-anchor" href="#Guiding-Center-Dynamics-in-4D">Guiding Center Dynamics in 4D</a><a id="Guiding-Center-Dynamics-in-4D-1"></a><a class="docs-heading-anchor-permalink" href="#Guiding-Center-Dynamics-in-4D" title="Permalink"></a></h1><p>Guiding centre dynamics is a reduced version of charged particle dynamics, where the motion of the particle in a strong magnetic field <span>$B$</span> is reduced to the motion of the guiding centre, that is the centre of the gyro motion of the particle about a magnetic field line. The dynamics of the guiding centre can be described in terms of only four coordinates (as compared to six for the full motion of the charged particle), the position of the guiding centre <span>$r = (x,y,z)$</span> and the parallel velocity <span>$u$</span>, where parallel refers to the direction of the magnetic field.</p><h2 id="Lagrangian-Formulation"><a class="docs-heading-anchor" href="#Lagrangian-Formulation">Lagrangian Formulation</a><a id="Lagrangian-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Lagrangian-Formulation" title="Permalink"></a></h2><p>The simplest form of the guiding centre equations can be obtained from the Lagrangian</p><p class="math-container">\[\begin{aligned}
L &amp;= (A (r) + u b (r)) \cdot \dot{r} - H(r,u) , &amp;
H &amp;= \tfrac{1}{2} u^{2} + \mu \vert B (r) \vert ,
\end{aligned}\]</p><p>where <span>$b = B / \vert B \vert$</span> is the unit vector of the magnetic field <span>$B = \nabla \times A$</span> with <span>$A$</span> the magnetic vector potential and <span>$\mu$</span> is the magnetic moment. The Euler-Lagrange equations are computed as</p><p class="math-container">\[\begin{aligned}
\nabla \vartheta^{T} ( r(t), u(t) ) \cdot \dot{r} (t) - \dot{\vartheta} ( r(t), u(t) ) &amp;= \nabla H ( r(t), u(t) ) , \\
b ( r(t) ) \cdot \dot{r} (t) &amp;= u (t) ,
\end{aligned}\]</p><p>with <span>$\vartheta(r,u) = A (r) + u \, b (r)$</span> and the gradient <span>$\nabla$</span> denoting the derivative with respect to <span>$r$</span>.</p><h2 id="Hamiltonian-Formulation"><a class="docs-heading-anchor" href="#Hamiltonian-Formulation">Hamiltonian Formulation</a><a id="Hamiltonian-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Hamiltonian-Formulation" title="Permalink"></a></h2><p>Computing the time derivative of <span>$\vartheta$</span>, the Euler-Lagrange equations can be rewritten in an explicit form as</p><p class="math-container">\[\begin{aligned}
\dot{r} (t) &amp;= \dfrac{u (t) \, \beta (r (t))}{b (r (t)) \cdot \beta (r (t))} + \dfrac{B (r (t))}{B (r (t)) \cdot \beta (r (t))} \times \nabla H (r (t),u (t)) , \\
\dot{u} (t) &amp;= - \dfrac{\beta (r (t))}{b (r (t)) \cdot \beta (r (t))} \cdot \nabla H (r (t), u (t)) ,
\end{aligned}\]</p><p>where <span>$\beta = \nabla \times \vartheta$</span>. This constitutes a noncanonical Hamiltonian system of the form</p><p class="math-container">\[\dot{q} = \Omega^{-T} (q) \nabla H(q) ,\]</p><p>with <span>$q = (x,y,z,u)$</span> and the symplectic matrix <span>$\Omega$</span> given by</p><p class="math-container">\[\Omega_{ij} = \dfrac{\partial \vartheta_{j}}{\partial q^{i}} - \dfrac{\partial \vartheta_{i}}{\partial q^{j}} .\]</p><h2 id="Modules"><a class="docs-heading-anchor" href="#Modules">Modules</a><a id="Modules-1"></a><a class="docs-heading-anchor-permalink" href="#Modules" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.SymmetricField" href="#ChargedParticleDynamics.GuidingCenter4d.SymmetricField"><code>ChargedParticleDynamics.GuidingCenter4d.SymmetricField</code></a> — <span class="docstring-category">Module</span></header><section><div><p>First and second Poincaré invariant for a guiding center particle in an axisymmetric magnetic field of the form <span>$B(x,y,z) = B_0 (1 + x^2 + y^2) e_z$</span>.</p><p>The loop for the first invariant is initialized by</p><p class="math-container">\[q (\tau) = \begin{pmatrix}
r_x \cos (2\pi \tau) \\
r_y \sin (2\pi \tau) \\
z_0 + z_1 \sin (2\pi \tau) \\
u_0 + u_1 \cos (2\pi \tau) \\
\end{pmatrix}\]</p><p>with parameters</p><p class="math-container">\[B_0 = 1, \quad
r_x = 0.5, \quad
r_y = 0.3, \quad
z_0 = 0.0, \quad
z_1 = 0.1, \quad
u_0 = 0.5, \quad
u_1 = 0.05, \quad
\mu = 0.01 .\]</p><p>The surface for the second invariant is initialized by</p><p class="math-container">\[q (\tau) = \begin{pmatrix}
r_0 (\sigma - 0.5) \\
r_0 (\tau   - 0.5) \\
z_0 + z_1 \cos (2\pi \sigma) \cos (2\pi \tau) \\
u_0 + u_1 \sin (2\pi \sigma) \sin (2\pi \tau) \\
\end{pmatrix}\]</p><p>with parameters</p><p class="math-container">\[B_0 = 1, \quad
r_0 = 0.5, \quad
z_0 = 0.0, \quad
z_1 = 0.1, \quad
u_0 = 0.5, \quad
u_1 = 0.01, \quad
\mu = 0.01 .\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/symmetric_quadratic.jl#L1-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.ThetaPinchField" href="#ChargedParticleDynamics.GuidingCenter4d.ThetaPinchField"><code>ChargedParticleDynamics.GuidingCenter4d.ThetaPinchField</code></a> — <span class="docstring-category">Module</span></header><section><div><p>First Poincaré invariant for a guiding center particle in an θ-pinch magnetic field of the form <span>$B(x,y,z) = B_0 \, e_z$</span>.</p><p>The loop for the first Poincaré invariant is initialized by</p><p class="math-container">\[q (\tau) = \begin{pmatrix}
r_x \cos (2\pi \tau) \\
y_0 \\
r_z \sin (2\pi \tau) \\
\end{pmatrix}\]</p><p>with parameters</p><p class="math-container">\[B_0 = 1, \quad
r_x = 0.5, \quad
r_z = 0.3, \quad
y_0 = 0.0, \quad
u_0 = 0.5, \quad
\mu = 2.5 \times 10^{-6} .\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/theta_pinch.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCartesian" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCartesian"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCartesian</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Analytic axisymmetric small tokamak equilibrium in cartesian coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/tokamak_small_cartesian.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCylindrical" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCylindrical"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCylindrical</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Analytic axisymmetric small tokamak equilibrium in cylindrical coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/tokamak_small_cylindrical.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakSmallToroidal" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakSmallToroidal"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakSmallToroidal</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Analytic axisymmetric small tokamak equilibrium in circular coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/tokamak_small_toroidal.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCartesian" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCartesian"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCartesian</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Analytic axisymmetric medium-size tokamak equilibrium in cartesian coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/tokamak_medium_cartesian.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCylindrical" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCylindrical"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCylindrical</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Analytic axisymmetric medium-size tokamak equilibrium in cartesian coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/tokamak_medium_cylindrical.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakIterCylindrical" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakIterCylindrical"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakIterCylindrical</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Analytic ITER-like Solov&#39;ev equilibrium with X-point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/tokamak_iter_cylindrical.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.SolovevIter" href="#ChargedParticleDynamics.GuidingCenter4d.SolovevIter"><code>ChargedParticleDynamics.GuidingCenter4d.SolovevIter</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Analytic ITER-like Solov&#39;ev equilibrium.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/solovev_iter.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.SolovevIterXpoint" href="#ChargedParticleDynamics.GuidingCenter4d.SolovevIterXpoint"><code>ChargedParticleDynamics.GuidingCenter4d.SolovevIterXpoint</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Analytic ITER-like Solov&#39;ev equilibrium with X-point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/bb3202d2585f1486366827830878d5fd4f2ce511/src/guiding_center_4d/solovev_iter_xpoint.jl#L1-L3">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pauli_particle_3d/">« Pauli Particles in 3D</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 16 December 2020 10:31">Wednesday 16 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
