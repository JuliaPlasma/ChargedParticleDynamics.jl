<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Initialization · ChargedParticleDynamics.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ChargedParticleDynamics.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../normalization/">Normalization</a></li><li class="is-active"><a class="tocitem" href>Initialization</a><ul class="internal"><li><a class="tocitem" href="#Velocities"><span>Velocities</span></a></li><li><a class="tocitem" href="#Gyro-radius-Vector-and-Position"><span>Gyro-radius Vector and Position</span></a></li><li><a class="tocitem" href="#Guiding-Center-Coordinates"><span>Guiding Center Coordinates</span></a></li><li><a class="tocitem" href="#Initial-Conditions"><span>Initial Conditions</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../charged_particle_3d/">Charged Particles in 3D</a></li><li><a class="tocitem" href="../pauli_particle_3d/">Pauli Particles in 3D</a></li><li><a class="tocitem" href="../guiding_center_4d/">Guiding Center Dynamics in 4D</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Initialization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Initialization</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/master/docs/src/initialization.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h1><p>In the following, we will discuss how to initialise the various models from a common set of initial data, namely</p><ul><li>the guiding center position <span>$X$</span> in physical coordinates,</li><li>the particle energy <span>$W$</span> in eV,</li><li>the particle mass <span>$m$</span> in kg,</li><li>the particle charge number,</li><li>the gyro angle <span>$\theta \in [0, 2\pi]$</span>,</li><li>the pitch angle <span>$\alpha \in [0, \pi / 2]$</span>.</li></ul><p>For charged particles we need to convert the energy into a velocity vector. For the Pauli particle we need to compute the coordinates of the guiding centre <span>$X$</span> of the particle and construct a velocity vector that only holds the component of the velocity that is parallel to the magnetic field, while the perpendicular component goes into the magnetic moment <span>$\mu$</span>. For the guiding center, we need the same coordinate transformation as for the Pauli particle, but we only need the absolute value of the velocity in direction of the magnetic field <span>$u$</span> and the magnetic moment <span>$\mu$</span>.</p><p>Make sure to read about the <a href="../normalization/#Normalization">Normalization</a> before proceeding.</p><h2 id="Velocities"><a class="docs-heading-anchor" href="#Velocities">Velocities</a><a id="Velocities-1"></a><a class="docs-heading-anchor-permalink" href="#Velocities" title="Permalink"></a></h2><p>Set <span>$e = e&#39; \hat{e}$</span> with <span>$e&#39; = 1.602 176 634 \cdot 10^{-19}$</span> and <span>$\hat{e} = \mathrm{C}$</span> and similarly <span>$m = m&#39; \hat{m}$</span> with <span>$\hat{m} = \mathrm{kg}$</span>. Some common values for the mass are</p><table><tr><th style="text-align: right">Particle</th><th style="text-align: right">Normalised Mass <span>$m&#39;$</span></th></tr><tr><td style="text-align: right">electron</td><td style="text-align: right"><span>$9.1093837015 \cdot 10^{-31}$</span></td></tr><tr><td style="text-align: right">proton</td><td style="text-align: right"><span>$1.6726219237 \cdot 10^{-27}$</span></td></tr><tr><td style="text-align: right">deuteron</td><td style="text-align: right"><span>$3.3435837724 \cdot 10^{-27}$</span></td></tr><tr><td style="text-align: right">alpha</td><td style="text-align: right"><span>$6.6446573357 \cdot 10^{-27}$</span></td></tr></table><p>The absolute value of the velocity is obtained from the particle energy by <span>$\vert v \vert^2 = 2 W / m$</span>. In normalised units, we have <span>$W = W&#39; \hat{W}$</span> and <span>$v = v&#39; \hat{v}$</span> where <span>$\hat{W} = e \mathrm{V}$</span> and <span>$\hat{v} = \hat{l} \hat{\omega}_c = \hat{l} \hat{B} e / m$</span>.</p><p>Let us compute the normalise kinetic energy,</p><p class="math-container">\[\frac{\vert v&#39; \vert^2}{2}
= \frac{W&#39; \hat{W}}{m \hat{v}^2}
= \frac{W&#39; e \mathrm{V} m^2}{m \hat{l}^2 \hat{B}^2 e^2} .\]</p><p>Usually, we have <span>$\hat{B} = T = \mathrm{kg} / \mathrm{C} \mathrm{s}$</span>. Recall that <span>$\mathrm{V} = \mathrm{kg} \mathrm{m}^2 / \mathrm{C} \mathrm{s}^2$</span> and let us set <span>$\hat{l} = l_0 \mathrm{m}$</span>, then</p><p class="math-container">\[\frac{\vert v&#39; \vert^2}{2} = \frac{m&#39; W&#39;}{e&#39; l_0^2} .\]</p><p>Thus for the absolute value of the velocity we have</p><p class="math-container">\[\vert v&#39; \vert = \frac{1}{l_0} \sqrt{ 2 W&#39; \, \frac{m&#39;}{e&#39;} } .\]</p><p>The pitch angle <span>$\alpha$</span> determines the distribution of the kinetic energy into the perpendicular and parallel components by</p><p class="math-container">\[\begin{aligned}
W_{\perp}&#39; &amp;= W&#39; \sin \alpha , \qquad
W_{\parallel}&#39; &amp;= W&#39; \, (1 - \sin \alpha) ,
\end{aligned}\]</p><p>and accordingly</p><p class="math-container">\[\begin{aligned}
\vert v_{\perp}&#39; \vert &amp;= \frac{1}{l_0} \sqrt{ 2 W_{\perp}&#39; \, \frac{m&#39;}{e&#39;} } , \qquad
\vert v_{\parallel}&#39; \vert &amp;= \frac{1}{l_0} \sqrt{ 2 W_{\parallel}&#39; \, \frac{m&#39;}{e&#39;} } .
\end{aligned}\]</p><p>The ElectromagneticFields.jl package provides three functions <code>a⃗(t,x)</code>, <code>b⃗(t,x)</code>, <code>c⃗(t,x)</code> that can be used to construct the velocity vector <span>$v$</span>. The function <code>b⃗</code> returns the unit vector of the magnetic field, thus</p><p class="math-container">\[v_{\parallel}&#39; = \vert v&#39; \vert \, (1 - \sin \alpha) \, b .\]</p><p>The functions <code>a⃗</code> and <code>c⃗</code> return two unit vectors that span the plane perpendicular to the magnetic field, thus</p><p class="math-container">\[v_{\perp}&#39; = \vert v&#39; \vert \, \sin \alpha ( - a \, \sin \theta - c \, \cos \theta ) ,\]</p><p>where <span>$\theta$</span> is the gyro angle. The magnetic moment is computed as</p><p class="math-container">\[\mu = \frac{ \vert v_{\perp}&#39; \vert^2 }{2 \vert B&#39; \vert} = \frac{ \vert v&#39; \vert^2 \sin \alpha }{2 \vert B&#39; \vert} .\]</p><h2 id="Gyro-radius-Vector-and-Position"><a class="docs-heading-anchor" href="#Gyro-radius-Vector-and-Position">Gyro-radius Vector and Position</a><a id="Gyro-radius-Vector-and-Position-1"></a><a class="docs-heading-anchor-permalink" href="#Gyro-radius-Vector-and-Position" title="Permalink"></a></h2><p>In order to compute the particle position, we need to construct the gyro radius vector <span>$\rho$</span>, which is given by</p><p class="math-container">\[\rho = \frac{b \times v}{\omega_c} = \frac{b \times \hat{v} v&#39;}{\hat{\omega_c} \omega_c&#39;}  = l_{0} \, \frac{b \times v&#39;}{\vert B&#39; \vert} .\]</p><p>Note that </p><p class="math-container">\[\omega_c
= \frac{e \vert B \vert}{m}
= \frac{e \vert \hat{B} B&#39; \vert}{m}
= \frac{e \vert \hat{B} \vert}{m} \vert B&#39; \vert
= \hat{\omega}_c \omega_c&#39; ,\]</p><p>as</p><p class="math-container">\[\hat{\omega}_c = \frac{e \vert \hat{B} \vert}{m} ,\]</p><p>so that</p><p class="math-container">\[\omega_c&#39; = \vert B&#39; \vert .\]</p><p>The normalized gyro radius vector reads</p><p class="math-container">\[\rho&#39; = \frac{\rho}{l_0} = \frac{b \times v&#39;}{\vert B&#39; \vert} ,\]</p><p>so that the normalised particle position is</p><p class="math-container">\[x&#39; = X&#39; + \rho&#39; .\]</p><p>The gyro phase <span>$\theta$</span> is defined as the angle, measured in the clockwise sense, between <span>$a$</span> and <span>$\rho$</span>, so that</p><p class="math-container">\[\frac{b \times v&#39;}{\vert v&#39; \vert \, \sin \alpha} = a \, \cos \theta - c \, \sin \theta .\]</p><h2 id="Guiding-Center-Coordinates"><a class="docs-heading-anchor" href="#Guiding-Center-Coordinates">Guiding Center Coordinates</a><a id="Guiding-Center-Coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Guiding-Center-Coordinates" title="Permalink"></a></h2><p>Instead of the particle energy <span>$W$</span> and pitch angle <span>$\alpha$</span>, we can also compute all initial conditions from the guiding center initial data, i.e., parallel velocity <span>$u = \vert v_{\parallel} \vert$</span>, magnetic moment <span>$\mu$</span> and gyro angle <span>$\theta$</span>.</p><p>Start by computing the absolute value of the perpendicular velocity by</p><p class="math-container">\[\vert v_\perp \vert = \sqrt{ 2 \mu \vert B \vert } ,\]</p><p>and the total velocity by</p><p class="math-container">\[\vert v \vert = \sqrt{ \vert v_{\parallel} \vert^2 + \vert v_\perp \vert^2 } .\]</p><p>With that, we can compute the perpendicular and total energy,</p><p class="math-container">\[\begin{aligned}
W_{\perp}&#39; &amp;= \frac{e l₀^2 \vert v_\perp \vert^2}{2m} , \qquad
W&#39; &amp;= \frac{e l₀^2 \vert v \vert^2}{2m} .
\end{aligned}\]</p><p>The pitch angle is obtained as</p><p class="math-container">\[\alpha = \arcsin \frac{W_{\perp}&#39;}{W&#39;} .\]</p><p>With that, the rest of the quantities can be computed in the same way as above.</p><h2 id="Initial-Conditions"><a class="docs-heading-anchor" href="#Initial-Conditions">Initial Conditions</a><a id="Initial-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Conditions" title="Permalink"></a></h2><p>ChargedParticleDynamics.jl provides the <code>InitialConditions</code> module for the computation of the above quantities. Three functions are provided that return the initial conditions for the different models. For charged particles the initial conditions are <span>$(x&#39;, v&#39;)$</span>, for the Pauli particle we have <span>$(X&#39;, v_{\parallel}&#39;, \mu)$</span> and for the guiding center we use <span>$(X&#39;, u&#39;, \mu)$</span> with <span>$u&#39; = \vert v_{\parallel}&#39; \vert$</span>.</p><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.InitialConditions" href="#ChargedParticleDynamics.InitialConditions"><code>ChargedParticleDynamics.InitialConditions</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Store initial conditions for charged particle, Pauli particle and guiding center models.</p><p>Fields:</p><ul><li><code>x</code>: particle position</li><li><code>X</code>: gyro center position</li><li><code>ρ</code>: gyro radius vector</li><li><code>vvec</code>: velocity vector</li><li><code>vpar</code>: parallel velocity vector</li><li><code>vper</code>: perpendicular velocity vector</li><li><code>v</code>: absolute value of velocity</li><li><code>u</code>: absolute value of parallel velocity</li><li><code>μ</code>: magnetic moment</li><li><code>θ</code>: gyro angle ∈ [0,2π]</li><li><code>α</code>: pitch angle ∈ [0,π/2]</li><li><code>ω</code>: gyro frequency</li><li><code>mass</code>: mass in kg</li><li><code>energy</code>: energy in eV</li><li><code>charge</code>: charge number</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/3e3f0fcca285346ef826f63819473341212ba295/src/initialization/initial_conditions.jl#L17-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.InitialConditions-Union{Tuple{T}, Tuple{AbstractArray{T,1},T,T,T,T,Any,Function,Function,Function,Function,Function,Function,Function,Function}} where T" href="#ChargedParticleDynamics.InitialConditions-Union{Tuple{T}, Tuple{AbstractArray{T,1},T,T,T,T,Any,Function,Function,Function,Function,Function,Function,Function,Function}} where T"><code>ChargedParticleDynamics.InitialConditions</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute initial conditions from the following arguments:</p><ul><li><code>X</code>: gyro center position</li><li><code>θ</code>: gyro angle</li><li><code>α</code>: pitch angle</li><li><code>E</code>: energy</li><li><code>M</code>: mass</li><li><code>C</code>: charge number</li><li><code>a</code>, b, c: magnetic field unit vectors in physical coordinates</li><li><code>b</code>: magnetic field unit vector in contravariant coordinates</li><li><code>B</code>: amplitude of magnetic field</li><li><code>g̅</code>: inverse metric coefficients</li><li><code>DF̄</code>: inverse Jacobian matrix</li><li><code>J</code>: Jacobian determinant</li><li><code>l=1</code>: length normalization</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/3e3f0fcca285346ef826f63819473341212ba295/src/initialization/initial_conditions.jl#L60-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.InitialConditionsGC-Union{Tuple{T}, Tuple{AbstractArray{T,1},T,T,T,T,Any,Function,Function,Function,Function,Function,Function,Function,Function}} where T" href="#ChargedParticleDynamics.InitialConditionsGC-Union{Tuple{T}, Tuple{AbstractArray{T,1},T,T,T,T,Any,Function,Function,Function,Function,Function,Function,Function,Function}} where T"><code>ChargedParticleDynamics.InitialConditionsGC</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compute initial conditions from the following arguments:</p><ul><li><code>X</code>: gyro center position</li><li><code>θ</code>: gyro angle</li><li><code>u</code>: absolute value of parallel velocity</li><li><code>μ</code>: magnetic moment</li><li><code>M</code>: mass</li><li><code>C</code>: charge number</li><li><code>a</code>, b, c: magnetic field unit vectors in physical coordinates</li><li><code>b</code>: magnetic field unit vector in contravariant coordinates</li><li><code>B</code>: amplitude of magnetic field</li><li><code>g̅</code>: inverse metric coefficients</li><li><code>DF̄</code>: inverse Jacobian matrix</li><li><code>J</code>: Jacobian determinant</li><li><code>l=1</code>: length normalization</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/3e3f0fcca285346ef826f63819473341212ba295/src/initialization/initial_conditions.jl#L109-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.charged_particle-Union{Tuple{InitialConditions{T}}, Tuple{T}} where T" href="#ChargedParticleDynamics.charged_particle-Union{Tuple{InitialConditions{T}}, Tuple{T}} where T"><code>ChargedParticleDynamics.charged_particle</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Extracts the charged particle initial conditions and returns the tuple <code>(x,v)</code>. If the keyword argument <code>noncanonical</code> is set to <code>true</code>, the functions returns the vector <code>vcat(x,v)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/3e3f0fcca285346ef826f63819473341212ba295/src/initialization/initial_conditions.jl#L177-L181">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.guiding_center-Union{Tuple{InitialConditions{T}}, Tuple{T}} where T" href="#ChargedParticleDynamics.guiding_center-Union{Tuple{InitialConditions{T}}, Tuple{T}} where T"><code>ChargedParticleDynamics.guiding_center</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Extracts the guiding center initial conditions and returns the tuple <code>(vcat(X,u),μ)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/3e3f0fcca285346ef826f63819473341212ba295/src/initialization/initial_conditions.jl#L191-L193">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChargedParticleDynamics.pauli_particle-Union{Tuple{InitialConditions{T}}, Tuple{T}} where T" href="#ChargedParticleDynamics.pauli_particle-Union{Tuple{InitialConditions{T}}, Tuple{T}} where T"><code>ChargedParticleDynamics.pauli_particle</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Extracts the Pauli particle initial conditions and returns the tuple <code>(X,vpar,μ)</code>. If the keyword argument <code>noncanonical</code> is set to <code>true</code>, the functions returns the tuple <code>(vcat(X,vpar),μ)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/3e3f0fcca285346ef826f63819473341212ba295/src/initialization/initial_conditions.jl#L199-L203">source</a></section></article><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>As an example, let us consider a deuteron in an ITER-like analytical equilibrium (obtained from <code>ElectromagneticFields.SolovevITER</code>). The guiding center position is <span>$[7, 0, 0]$</span>, the energy is <span>$1 \, \mathrm{MeV}$</span>, and the pitch angle is <span>$\pi / 2$</span>.</p>0.008<p>Below we plot the guiding center position (in red) and the particle position (in blue) in the poloidal plane for various gyro angles <span>$\in [0, 2\pi]$</span>.</p><p><img src="initial_conditions.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../normalization/">« Normalization</a><a class="docs-footer-nextpage" href="../charged_particle_3d/">Charged Particles in 3D »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 16 December 2020 10:12">Wednesday 16 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
