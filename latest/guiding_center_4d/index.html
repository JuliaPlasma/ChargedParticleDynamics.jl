<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Guiding Center Dynamics in 4D · ChargedParticleDynamics.jl</title><meta name="title" content="Guiding Center Dynamics in 4D · ChargedParticleDynamics.jl"/><meta property="og:title" content="Guiding Center Dynamics in 4D · ChargedParticleDynamics.jl"/><meta property="twitter:title" content="Guiding Center Dynamics in 4D · ChargedParticleDynamics.jl"/><meta name="description" content="Documentation for ChargedParticleDynamics.jl."/><meta property="og:description" content="Documentation for ChargedParticleDynamics.jl."/><meta property="twitter:description" content="Documentation for ChargedParticleDynamics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ChargedParticleDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../normalization/">Normalization</a></li><li><a class="tocitem" href="../initialization/">Initialization</a></li><li><a class="tocitem" href="../charged_particle_3d/">Charged Particles in 3D</a></li><li><a class="tocitem" href="../pauli_particle_3d/">Pauli Particles in 3D</a></li><li class="is-active"><a class="tocitem" href>Guiding Center Dynamics in 4D</a><ul class="internal"><li><a class="tocitem" href="#Lagrangian-Formulation"><span>Lagrangian Formulation</span></a></li><li><a class="tocitem" href="#Hamiltonian-Formulation"><span>Hamiltonian Formulation</span></a></li><li><a class="tocitem" href="#Modules"><span>Modules</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Guiding Center Dynamics in 4D</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Guiding Center Dynamics in 4D</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/main/docs/src/guiding_center_4d.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Guiding-Center-Dynamics-in-4D"><a class="docs-heading-anchor" href="#Guiding-Center-Dynamics-in-4D">Guiding Center Dynamics in 4D</a><a id="Guiding-Center-Dynamics-in-4D-1"></a><a class="docs-heading-anchor-permalink" href="#Guiding-Center-Dynamics-in-4D" title="Permalink"></a></h1><p>Guiding centre dynamics is a reduced version of charged particle dynamics, where the motion of the particle in a strong magnetic field <span>$B$</span> is reduced to the motion of the guiding centre, that is the centre of the gyro motion of the particle about a magnetic field line. The dynamics of the guiding centre can be described in terms of only four coordinates (as compared to six for the full motion of the charged particle), the position of the guiding centre <span>$r = (x,y,z)$</span> and the parallel velocity <span>$u$</span>, where parallel refers to the direction of the magnetic field.</p><h2 id="Lagrangian-Formulation"><a class="docs-heading-anchor" href="#Lagrangian-Formulation">Lagrangian Formulation</a><a id="Lagrangian-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Lagrangian-Formulation" title="Permalink"></a></h2><p>The simplest form of the guiding centre equations can be obtained from the Lagrangian</p><p class="math-container">\[\begin{aligned}
L &amp;= (A (r) + u b (r)) \cdot \dot{r} - H(r,u) , &amp;
H &amp;= \tfrac{1}{2} u^{2} + \mu \vert B (r) \vert ,
\end{aligned}\]</p><p>where <span>$b = B / \vert B \vert$</span> is the unit vector of the magnetic field <span>$B = \nabla \times A$</span> with <span>$A$</span> the magnetic vector potential and <span>$\mu$</span> is the magnetic moment. The Euler-Lagrange equations are computed as</p><p class="math-container">\[\begin{aligned}
\nabla \vartheta^{T} ( r(t), u(t) ) \cdot \dot{r} (t) - \dot{\vartheta} ( r(t), u(t) ) &amp;= \nabla H ( r(t), u(t) ) , \\
b ( r(t) ) \cdot \dot{r} (t) &amp;= u (t) ,
\end{aligned}\]</p><p>with <span>$\vartheta(r,u) = A (r) + u \, b (r)$</span> and the gradient <span>$\nabla$</span> denoting the derivative with respect to <span>$r$</span>.</p><h2 id="Hamiltonian-Formulation"><a class="docs-heading-anchor" href="#Hamiltonian-Formulation">Hamiltonian Formulation</a><a id="Hamiltonian-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Hamiltonian-Formulation" title="Permalink"></a></h2><p>Computing the time derivative of <span>$\vartheta$</span>, the Euler-Lagrange equations can be rewritten in an explicit form as</p><p class="math-container">\[\begin{aligned}
\dot{r} (t) &amp;= \dfrac{u (t) \, \beta (r (t))}{b (r (t)) \cdot \beta (r (t))} + \dfrac{B (r (t))}{B (r (t)) \cdot \beta (r (t))} \times \nabla H (r (t),u (t)) , \\
\dot{u} (t) &amp;= - \dfrac{\beta (r (t))}{b (r (t)) \cdot \beta (r (t))} \cdot \nabla H (r (t), u (t)) ,
\end{aligned}\]</p><p>where <span>$\beta = \nabla \times \vartheta$</span>. This constitutes a noncanonical Hamiltonian system of the form</p><p class="math-container">\[\dot{q} = \Omega^{-T} (q) \nabla H(q) ,\]</p><p>with <span>$q = (x,y,z,u)$</span> and the symplectic matrix <span>$\Omega$</span> given by</p><p class="math-container">\[\Omega_{ij} = \dfrac{\partial \vartheta_{j}}{\partial q^{i}} - \dfrac{\partial \vartheta_{i}}{\partial q^{j}} .\]</p><h2 id="Modules"><a class="docs-heading-anchor" href="#Modules">Modules</a><a id="Modules-1"></a><a class="docs-heading-anchor-permalink" href="#Modules" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.SymmetricField" href="#ChargedParticleDynamics.GuidingCenter4d.SymmetricField"><code>ChargedParticleDynamics.GuidingCenter4d.SymmetricField</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>First and second Poincaré invariant for a guiding center particle in an axisymmetric magnetic field of the form <span>$B(x,y,z) = B_0 (1 + x^2 + y^2) e_z$</span>.</p><p>The loop for the first invariant is initialized by</p><p class="math-container">\[q (\tau) = \begin{pmatrix}
r_x \cos (2\pi \tau) \\
r_y \sin (2\pi \tau) \\
z_0 + z_1 \sin (2\pi \tau) \\
u_0 + u_1 \cos (2\pi \tau) \\
\end{pmatrix}\]</p><p>with parameters</p><p class="math-container">\[B_0 = 1, \quad
r_x = 0.5, \quad
r_y = 0.3, \quad
z_0 = 0.0, \quad
z_1 = 0.1, \quad
u_0 = 0.5, \quad
u_1 = 0.05, \quad
\mu = 0.01 .\]</p><p>The surface for the second invariant is initialized by</p><p class="math-container">\[q (\tau) = \begin{pmatrix}
r_0 (\sigma - 0.5) \\
r_0 (\tau   - 0.5) \\
z_0 + z_1 \cos (2\pi \sigma) \cos (2\pi \tau) \\
u_0 + u_1 \sin (2\pi \sigma) \sin (2\pi \tau) \\
\end{pmatrix}\]</p><p>with parameters</p><p class="math-container">\[B_0 = 1, \quad
r_0 = 0.5, \quad
z_0 = 0.0, \quad
z_1 = 0.1, \quad
u_0 = 0.5, \quad
u_1 = 0.01, \quad
\mu = 0.01 .\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/symmetric_quadratic.jl#L1-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.ThetaPinchField" href="#ChargedParticleDynamics.GuidingCenter4d.ThetaPinchField"><code>ChargedParticleDynamics.GuidingCenter4d.ThetaPinchField</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>First Poincaré invariant for a guiding center particle in an θ-pinch magnetic field of the form <span>$B(x,y,z) = B_0 \, e_z$</span>.</p><p>The loop for the first Poincaré invariant is initialized by</p><p class="math-container">\[q (\tau) = \begin{pmatrix}
r_x \cos (2\pi \tau) \\
y_0 \\
r_z \sin (2\pi \tau) \\
\end{pmatrix}\]</p><p>with parameters</p><p class="math-container">\[B_0 = 1, \quad
r_x = 0.5, \quad
r_z = 0.3, \quad
y_0 = 0.0, \quad
u_0 = 0.5, \quad
\mu = 2.5 \times 10^{-6} .\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/theta_pinch.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCartesian" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCartesian"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCartesian</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic axisymmetric small tokamak equilibrium in cartesian coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/tokamak_small_cartesian.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCylindrical" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCylindrical"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakSmallCylindrical</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic axisymmetric small tokamak equilibrium in cylindrical coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/tokamak_small_cylindrical.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakSmallToroidal" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakSmallToroidal"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakSmallToroidal</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic axisymmetric small tokamak equilibrium in circular coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/tokamak_small_toroidal.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCartesian" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCartesian"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCartesian</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic axisymmetric medium-size tokamak equilibrium in cartesian coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/tokamak_medium_cartesian.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCylindrical" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCylindrical"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakMediumCylindrical</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic axisymmetric medium-size tokamak equilibrium in cartesian coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/tokamak_medium_cylindrical.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.TokamakIterCylindrical" href="#ChargedParticleDynamics.GuidingCenter4d.TokamakIterCylindrical"><code>ChargedParticleDynamics.GuidingCenter4d.TokamakIterCylindrical</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic ITER-like Solov&#39;ev equilibrium with X-point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/tokamak_iter_cylindrical.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.SolovevIter" href="#ChargedParticleDynamics.GuidingCenter4d.SolovevIter"><code>ChargedParticleDynamics.GuidingCenter4d.SolovevIter</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic ITER-like Solov&#39;ev equilibrium.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/solovev_iter.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChargedParticleDynamics.GuidingCenter4d.SolovevIterXpoint" href="#ChargedParticleDynamics.GuidingCenter4d.SolovevIterXpoint"><code>ChargedParticleDynamics.GuidingCenter4d.SolovevIterXpoint</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analytic ITER-like Solov&#39;ev equilibrium with X-point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPlasma/ChargedParticleDynamics.jl/blob/7b3ab53ebcb85592c0a1102c324678bb98314ac8/src/guiding_center_4d/solovev_iter_xpoint.jl#L1-L3">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pauli_particle_3d/">« Pauli Particles in 3D</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 3 December 2024 14:38">Tuesday 3 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
